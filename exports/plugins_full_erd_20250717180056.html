<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Plugins Full ER Diagram - Mermaid Live Editor</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0;
            padding: 0;
            height: 100vh;
            background: #f5f5f5;
        }
        .left-panel {
            width: 15%;
            min-width: 250px;
            padding: 12px;
            background: white;
            font-size: 12px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            overflow-y: auto;
        }
        .code-block {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            font-family: monospace;
            white-space: pre-wrap;
            margin: 8px 0;
            font-size: 12px;
            max-height: 60vh;
            overflow-y: auto;
            width: 100%;
            box-sizing: border-box;
            cursor: text;
            user-select: text;
        }
        .code-block:hover {
            border-color: #2196F3;
        }
        .button {
            background: #2196F3;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin: 4px 0;
            white-space: nowrap;
            width: 100%;
            text-align: center;
            text-decoration: none;
            display: block;
            box-sizing: border-box;
        }
        .button:hover {
            background: #1976D2;
        }
        .success-message {
            display: none;
            color: #4CAF50;
            margin: 4px 0;
            font-size: 12px;
            padding: 4px;
            background: #E8F5E9;
            border-radius: 4px;
            text-align: center;
        }
        .error-message {
            display: none;
            color: #FF9800;
            margin: 4px 0;
            font-size: 12px;
            padding: 4px;
            background: #FFF3E0;
            border-radius: 4px;
            text-align: center;
        }
        h1 { 
            margin: 0 0 8px 0; 
            font-size: 1.4em;
            font-weight: bold;
        }
        h2 {
            margin: 8px 0;
            font-size: 1.1em;
            font-weight: normal;
        }
        h3 {
            margin: 8px 0;
            font-size: 1em;
        }
        h4 {
            margin: 8px 0;
            font-size: 0.9em;
            font-weight: bold;
        }
        .instructions {
            background: #e3f2fd;
            padding: 8px;
            border-radius: 4px;
            margin: 8px 0;
            font-size: 12px;
        }
        #paste-reminder {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            background: #E3F2FD;
            padding: 12px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 1000;
            font-size: 14px;
            animation: fadeInOut 5s forwards;
        }
        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="left-panel">
        <h1>Plugins Full ER</h1>
        <h2>Complete plugins ER diagram with all relationships</h2>
        <h3>ER Diagram</h3>
        <div class="instructions">
            <h4>Quick Steps</h4>
            <ol>
                <li>Click "Open Editor & Copy"</li>
                <li>Wait for editor to load</li>
                <li>Press Ctrl+V to paste</li>
            </ol>
        </div>
        <button class="button" onclick="openEditorAndCopy()">Open Editor & Copy</button>
        <div id="copySuccess" class="success-message">‚úì Code copied! Press Ctrl+V to paste</div>
        <div id="copyError" class="error-message">Failed to copy code. Please select and copy manually.</div>
        <button class="button" onclick="manualCopy()" style="background: #FF9800; margin-top: 8px;">üìã Manual Copy Only</button>
        <button class="button" onclick="showDebugInfo()" style="background: #9C27B0; margin-top: 4px;">üêõ Debug Info</button>
        <div class="code-block" id="mermaidSource">erDiagram
    "api - apiAccessKey" {
        UUID ObjectID
    }

    "microsoftud - mudGroup" {
        UUID ObjectID
    }

    "microsoftud - mudUser" {
        UUID ObjectID
        array Microsoft UD User
        UUID lGroups
    }

    "pathway - activity" {
        UUID ObjectID
        UUID Activity Instance
        UUID activityDefID
    }

    "pathway - activityDef" {
        UUID ObjectID
        UUID Farcry Activity Definition
        UUID title
        UUID stepNum
        UUID role
        UUID onEndID
        UUID description
        UUID aCuePointActivities
        UUID aMediaIDs
        UUID releaseMedia
        UUID includeFieldsInteract1
        UUID includeFieldsInteract2
        UUID includeFieldsInteract3
        UUID includeFieldsInteract4
        UUID includeFieldsInteract5
        UUID jReviewHTML
        UUID tracker02ID
        UUID tracker03ID
        UUID tracker04ID
        UUID tracker05ID
    }

    "pathway - address" {
        UUID ObjectID
        UUID Addresses
        UUID dmProfileID
    }

    "pathway - center" {
        UUID ObjectID
        UUID Center
        UUID center
        UUID dmProfileID
        UUID partnerID
        UUID memberGroupID
        UUID aReferers
    }

    "pathway - guide" {
        UUID ObjectID
        UUID Guide
        UUID guide
        UUID centerID
    }

    "pathway - intake" {
        UUID ObjectID
        UUID Intake
        UUID centerID
        UUID pipeOrgID
    }

    "pathway - journalDef" {
        UUID ObjectID
        UUID Journal Definition
        UUID tracker02Title
        UUID programmeID
    }

    "pathway - media" {
        UUID ObjectID
        UUID Media
        UUID partnerID
        UUID programmeID
        UUID roleID
    }

    "pathway - member" {
        UUID ObjectID
        UUID Member
        UUID memberGroupID
        UUID member
        UUID member
        UUID member
        UUID member
        UUID aAddresses
        UUID ssoID
        UUID caseness
    }

    "pathway - memberGroup" {
        UUID ObjectID
        array Member Group
        array UtmSourceID
        UUID bDefault
        UUID memberGroup
        UUID resourceHandoutID
        UUID supportPage
        UUID bAftercare
        UUID selfRegQrFileID
    }

    "pathway - memberType" {
        UUID ObjectID
    }

    "pathway - module" {
        UUID ObjectID
        array Farcry Module Instance
        array title
        UUID completionDate
        UUID referenceID
        UUID currPos
        UUID currActivityDefID
        UUID aModule
        UUID aActivity
        UUID aQuestionnaire
        UUID aTracker
    }

    "pathway - moduleDef" {
        UUID ObjectID
        UUID Farcry Activity Definition
        UUID lTypenames
        UUID currPos
        UUID currActivityDefID
        UUID aModule
        UUID aActivity
        UUID aQuestionnaire
        UUID aTracker
    }

    "pathway - orderItem" {
        UUID ObjectID
    }

    "pathway - orderMaster" {
        UUID ObjectID
        UUID Order
    }

    "pathway - partner" {
        UUID ObjectID
        UUID Partner
        UUID partner
        UUID seniorSupportID
        UUID aCenters
        UUID aReferers
    }

    "pathway - progMember" {
        UUID ObjectID
        UUID Program Member
        UUID memberID
        UUID DOW
    }

    "pathway - programme" {
        UUID ObjectID
        UUID Programme
        UUID Title
        UUID programme
        UUID lastActivityDefID
        UUID lSSQpoints
        UUID aTrackerIDs
        UUID aObjectIDs
    }

    "pathway - progRole" {
        UUID ObjectID
        UUID ProgRole
    }

    "pathway - referer" {
        UUID ObjectID
        UUID Referrer
        UUID guide
        UUID partnerID
        UUID memberGroupID
        UUID centerID
    }

    "pathway - report" {
        UUID ObjectID
        UUID Report
        UUID partnerID
        UUID memberID
        UUID memberTypeID
        UUID aMemberGroupID
    }

    "pathway - shopItem" {
        UUID ObjectID
        UUID Shop Item
    }

    "pathway - testimonial" {
        UUID ObjectID
        UUID Testimonial Instance
        UUID activityDefID
    }

    "pathway - trackerDef" {
        UUID ObjectID
        UUID Tracker Definition
    }

    "social - dmProfile" {
        UUID ObjectID
    }

    "microsoftud - mudUser" }o--|| "mudGroup" : lGroups
    "pathway - activity" }o--|| "progMember" : Activity Instance
    "pathway - activity" }o--|| "activityDef" : activityDefID
    "pathway - activityDef" }o--|| "programme" : Farcry Activity Definition
    "pathway - activityDef" }o--|| "dmImage" : title
    "pathway - activityDef" }o--|| "guide" : stepNum
    "pathway - activityDef" }o--|| "progRole" : role
    "pathway - activityDef" }o--|| "activityDef" : onEndID
    "pathway - activityDef" }o--|| "media" : description
    "pathway - activityDef" }o--|| "activityDef" : aCuePointActivities
    "pathway - activityDef" }o--|| "media" : aMediaIDs
    "pathway - activityDef" }o--|| "activityDef" : releaseMedia
    "pathway - activityDef" }o--|| "activityDef" : includeFieldsInteract1
    "pathway - activityDef" }o--|| "activityDef" : includeFieldsInteract2
    "pathway - activityDef" }o--|| "activityDef" : includeFieldsInteract3
    "pathway - activityDef" }o--|| "activityDef" : includeFieldsInteract4
    "pathway - activityDef" }o--|| "journalDef" : includeFieldsInteract5
    "pathway - activityDef" }o--|| "trackerDef" : jReviewHTML
    "pathway - activityDef" }o--|| "trackerDef" : tracker02ID
    "pathway - activityDef" }o--|| "trackerDef" : tracker03ID
    "pathway - activityDef" }o--|| "trackerDef" : tracker04ID
    "pathway - activityDef" }o--|| "trackerDef" : tracker05ID
    "pathway - address" }o--|| "member" : Addresses
    "pathway - address" }o--|| "dmProfile" : dmProfileID
    "pathway - center" }o--|| "dmImage" : Center
    "pathway - center" }o--|| "dmProfile" : center
    "pathway - center" }o--|| "dmProfile" : dmProfileID
    "pathway - center" }o--|| "partner" : partnerID
    "pathway - center" }o--|| "memberGroup" : memberGroupID
    "pathway - center" }o--|| "referer" : aReferers
    "pathway - guide" }o--|| "dmImage" : Guide
    "pathway - guide" }o--|| "partner" : guide
    "pathway - guide" }o--|| "center" : centerID
    "pathway - intake" }o--|| "memberGroup" : Intake
    "pathway - intake" }o--|| "center" : centerID
    "pathway - intake" }o--|| "member" : pipeOrgID
    "pathway - journalDef" }o--|| "trackerDef" : Journal Definition
    "pathway - journalDef" }o--|| "trackerDef" : tracker02Title
    "pathway - journalDef" }o--|| "programme" : programmeID
    "pathway - media" }o--|| "guide" : Media
    "pathway - media" }o--|| "partner" : partnerID
    "pathway - media" }o--|| "programme" : programmeID
    "pathway - media" }o--|| "progRole" : roleID
    "pathway - member" }o--|| "memberType" : Member
    "pathway - member" }o--|| "memberGroup" : memberGroupID
    "pathway - member" }o--|| "partner" : member
    "pathway - member" }o--|| "center" : member
    "pathway - member" }o--|| "referer" : member
    "pathway - member" }o--|| "orderMaster" : member
    "pathway - member" }o--|| "address" : aAddresses
    "pathway - member" }o--|| "activityDef" : ssoID
    "pathway - member" }o--|| "progRole" : caseness
    "pathway - memberGroup" }o--|| "dmImage" : bDefault
    "pathway - memberGroup" }o--|| "dmFile" : memberGroup
    "pathway - memberGroup" }o--|| "dmFile" : resourceHandoutID
    "pathway - memberGroup" }o--|| "dmHTML" : supportPage
    "pathway - memberGroup" }o--|| "dmNavigation" : bAftercare
    "pathway - memberGroup" }o--|| "dmFile" : selfRegQrFileID
    "pathway - module" }o--|| "moduleDef" : completionDate
    "pathway - module" }o--|| "member" : referenceID
    "pathway - module" }o--|| "module" : currPos
    "pathway - module" }o--|| "activity" : currActivityDefID
    "pathway - module" }o--|| "dmFile" : aModule
    "pathway - module" }o--|| "dmFile" : aActivity
    "pathway - module" }o--|| "dmFile" : aQuestionnaire
    "pathway - module" }o--|| "dmFile" : aTracker
    "pathway - moduleDef" }o--|| "activityDef" : Farcry Activity Definition
    "pathway - moduleDef" }o--|| "member" : lTypenames
    "pathway - moduleDef" }o--|| "module" : currPos
    "pathway - moduleDef" }o--|| "activity" : currActivityDefID
    "pathway - moduleDef" }o--|| "dmFile" : aModule
    "pathway - moduleDef" }o--|| "dmFile" : aActivity
    "pathway - moduleDef" }o--|| "dmFile" : aQuestionnaire
    "pathway - moduleDef" }o--|| "dmFile" : aTracker
    "pathway - orderMaster" }o--|| "shopItem" : Order
    "pathway - partner" }o--|| "dmImage" : Partner
    "pathway - partner" }o--|| "dmProfile" : partner
    "pathway - partner" }o--|| "dmProfile" : seniorSupportID
    "pathway - partner" }o--|| "center" : aCenters
    "pathway - partner" }o--|| "referer" : aReferers
    "pathway - progMember" }o--|| "programme" : Program Member
    "pathway - progMember" }o--|| "member" : memberID
    "pathway - progMember" }o--|| "activity" : DOW
    "pathway - programme" }o--|| "partner" : Programme
    "pathway - programme" }o--|| "dmImage" : Title
    "pathway - programme" }o--|| "activityDef" : programme
    "pathway - programme" }o--|| "activityDef" : lastActivityDefID
    "pathway - programme" }o--|| "activityDef" : lSSQpoints
    "pathway - programme" }o--|| "trackerDef" : aTrackerIDs
    "pathway - programme" }o--|| "dmFile" : aObjectIDs
    "pathway - progRole" }o--|| "programme" : ProgRole
    "pathway - referer" }o--|| "dmImage" : Referrer
    "pathway - referer" }o--|| "dmProfile" : guide
    "pathway - referer" }o--|| "partner" : partnerID
    "pathway - referer" }o--|| "memberGroup" : memberGroupID
    "pathway - referer" }o--|| "center" : centerID
    "pathway - report" }o--|| "programme" : Report
    "pathway - report" }o--|| "partner" : partnerID
    "pathway - report" }o--|| "member" : memberID
    "pathway - report" }o--|| "memberType" : memberTypeID
    "pathway - report" }o--|| "memberGroup" : aMemberGroupID
    "pathway - shopItem" }o--|| "shopItem" : Shop Item
    "pathway - testimonial" }o--|| "member" : Testimonial Instance
    "pathway - testimonial" }o--|| "activityDef" : activityDefID
    "pathway - trackerDef" }o--|| "programme" : Tracker Definition
    "microsoftud - mudUser_amudGroup" }o--|| "microsoftud - mudUser" : parentid
    "microsoftud - mudUser_amudGroup" }o--|| "mudGroup" : data
    "pathway - memberGroup_apartner" }o--|| "pathway - memberGroup" : parentid
    "pathway - memberGroup_apartner" }o--|| "partner" : data
    "pathway - memberGroup_afarUser" }o--|| "pathway - memberGroup" : parentid
    "pathway - memberGroup_afarUser" }o--|| "farUser" : data
    "pathway - module_aprogMember" }o--|| "pathway - module" : parentid
    "pathway - module_aprogMember" }o--|| "progMember" : data
    "pathway - module_aactivity" }o--|| "pathway - module" : parentid
    "pathway - module_aactivity" }o--|| "activity" : data</div>
    </div>

    <div id="paste-reminder">
        Press Ctrl+V to paste your diagram code!
    </div>

    <script>
    function showPasteReminder() {
        const reminder = document.getElementById('paste-reminder');
        reminder.style.display = 'block';
        setTimeout(() => {
            reminder.style.display = 'none';
        }, 5000);
    }

    function openEditorAndCopy() {
        // Get the code from the div instead of using a template string
        const mermaidContent = document.getElementById('mermaidSource').textContent;
        
        console.log('Attempting to copy:', mermaidContent.substring(0, 100) + '...');
        console.log('Full content length:', mermaidContent.length);
        
        // Try modern clipboard API first
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(mermaidContent).then(() => {
                console.log('Clipboard API success');
                // Show success message
                const msg = document.getElementById('copySuccess');
                msg.style.display = 'block';
                setTimeout(() => msg.style.display = 'none', 3000);
                
                // Open Mermaid Live Editor in new tab
                window.open('https://mermaid.live/edit', '_blank');
                
                // Show paste reminder
                showPasteReminder();
            }).catch(err => {
                console.error('Clipboard API failed:', err);
                showCopyError();
            });
        } else {
            console.log('Using fallback copy method');
            fallbackCopy();
        }
        
        function fallbackCopy() {
            try {
                const textArea = document.createElement('textarea');
                textArea.value = mermaidContent;
                textArea.style.position = 'fixed';
                textArea.style.left = '-999999px';
                textArea.style.top = '-999999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                const successful = document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (successful) {
                    console.log('execCommand success');
                    const msg = document.getElementById('copySuccess');
                    msg.style.display = 'block';
                    msg.textContent = '‚úì Code copied! Press Ctrl+V to paste';
                    setTimeout(() => msg.style.display = 'none', 3000);
                    
                    // Open editor with URL parameters
                    const editorUrl = 'https://mermaid.live/edit';
                    
                    // Open Mermaid Live Editor in new tab
                    window.open(editorUrl, '_blank');
                    
                    setTimeout(showPasteReminder, 1000);
                } else {
                    console.log('execCommand failed');
                    showCopyError();
                }
            } catch (err) {
                console.error('execCommand error:', err);
                showCopyError();
            }
        }

        function showCopyError() {
            const msg = document.getElementById('copyError');
            msg.style.display = 'block';
            setTimeout(() => msg.style.display = 'none', 5000);
        }
    }

    function manualCopy() {
        const mermaidContent = document.getElementById('mermaidSource').textContent;
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(mermaidContent).then(() => {
                const msg = document.getElementById('copySuccess');
                msg.style.display = 'block';
                msg.textContent = '‚úì Code copied! Press Ctrl+V to paste';
                setTimeout(() => msg.style.display = 'none', 3000);
                console.log('Manual copy successful via Clipboard API');
            }).catch(err => {
                const msg = document.getElementById('copyError');
                msg.style.display = 'block';
                msg.textContent = 'Failed to copy code. Please select and copy manually.';
                setTimeout(() => msg.style.display = 'none', 5000);
                console.error('Manual copy failed via Clipboard API:', err);
            });
        } else {
            try {
                const textArea = document.createElement('textarea');
                textArea.value = mermaidContent;
                textArea.style.position = 'fixed';
                textArea.style.left = '-999999px';
                textArea.style.top = '-999999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                const successful = document.execCommand('copy');
                document.body.removeChild(textArea);
                if (successful) {
                    const msg = document.getElementById('copySuccess');
                    msg.style.display = 'block';
                    msg.textContent = '‚úì Code copied! Press Ctrl+V to paste';
                    setTimeout(() => msg.style.display = 'none', 3000);
                    console.log('Manual copy successful via execCommand');
                } else {
                    const msg = document.getElementById('copyError');
                    msg.style.display = 'block';
                    msg.textContent = 'Failed to copy code. Please select and copy manually.';
                    setTimeout(() => msg.style.display = 'none', 5000);
                    console.log('Manual copy failed via execCommand');
                }
            } catch (err) {
                const msg = document.getElementById('copyError');
                msg.style.display = 'block';
                msg.textContent = 'Failed to copy code. Please select and copy manually.';
                setTimeout(() => msg.style.display = 'none', 5000);
                console.error('Manual copy failed via execCommand:', err);
            }
        }
    }

    function showDebugInfo() {
        const mermaidContent = document.getElementById('mermaidSource').textContent;
        console.log('=== DEBUG INFO ===');
        console.log('Content length:', mermaidContent.length);
        console.log('First 200 chars:', mermaidContent.substring(0, 200));
        console.log('Last 100 chars:', mermaidContent.substring(mermaidContent.length - 100));
        console.log('Contains "erDiagram":', mermaidContent.includes('erDiagram'));
        console.log('Contains "classDiagram":', mermaidContent.includes('classDiagram'));
        console.log('Full content:');
        console.log(mermaidContent);
        
        // Show in an alert for easy viewing
        alert('Content length: ' + mermaidContent.length + '\n\nFirst 200 chars:\n' + mermaidContent.substring(0, 200) + '\n\nContains erDiagram: ' + mermaidContent.includes('erDiagram'));
    }
    </script>
</body>
</html>
